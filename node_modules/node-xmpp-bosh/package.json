{
  "name": "node-xmpp-bosh",
  "version": "0.7.0",
  "main": "./src/main",
  "bin": {
    "bosh-server": "./run-server.js"
  },
  "description": "An XMPP BOSH server written for node.js in javascript",
  "author": {
    "name": "Dhruv Matani"
  },
  "dependencies": {
    "node-expat": "~2.0.0",
    "ltx": "~0.1.2",
    "node-uuid": "~1.3.3",
    "tav": "~0.1.0",
    "underscore": "~1.3.3",
    "eventpipe": "~0.0.5",
    "dns-srv": "~0.0.6",
    "semver": "~1.0.8",
    "ws": "= 0.4.19",
    "node-lumberjack": "= 0.0.4",
    "ejs": "~0.8.3"
  },
  "devDependencies": {
    "jsdom": "~0.2.15",
    "jslint": "~0.1.9"
  },
  "repositories": [
    {
      "type": "git",
      "path": "git://github.com/dhruvbird/node-xmpp-bosh.git"
    }
  ],
  "homepage": "https://github.com/dhruvbird/node-xmpp-bosh",
  "bugs": "https://github.com/dhruvbird/node-xmpp-bosh/issues",
  "maintainers": [
    {
      "name": "Dhruv Matani",
      "email": "dhruvbird@gmail.com",
      "url": "http://dhruvbird.com/"
    },
    {
      "name": "Anup Kalbalia",
      "email": "anup.kalbalia@gmail.com"
    },
    {
      "name": "Satyam Shekhar",
      "email": "satyamshekhar@gmail.com",
      "url": "http://satyamshekhar.com/"
    }
  ],
  "contributors": [
    {
      "name": "Vanaryon",
      "email": "val.saliou@gmail.com",
      "url": "http://jappix.com/"
    },
    {
      "name": "Emmanuel Gil Peyrot",
      "email": "linkmauve@linkmauve.fr",
      "url": "http://linkmauve.fr/"
    },
    {
      "name": "Julien Genestoux",
      "email": "julien.genestoux@gmail.com",
      "url": "http://ouvre-boite.com/"
    },
    {
      "name": "Sonny Piers",
      "email": "sonny@fastmail.net"
    },
    {
      "name": "Aria Stewart",
      "email": "aredridel@nbtsc.org"
    }
  ],
  "licenses": [
    {
      "type": "MIT"
    }
  ],
  "engines": {
    "node": ">=0.6.12"
  },
  "readme": "# node-xmpp-bosh\n\nAn XMPP BOSH & WebSocket server (connection manager) written using node.js in Javascript\n\nProject Home Page:\n[https://github.com/dhruvbird/node-xmpp-bosh](https://github.com/dhruvbird/node-xmpp-bosh)\n\n### [What's Changed?](https://github.com/dhruvbird/node-xmpp-bosh/blob/master/whats_changed.md)\n\nPlease see [whats_changed.md](https://github.com/dhruvbird/node-xmpp-bosh/blob/master/whats_changed.md)\nto see the major changes in releases.\n\n\n### Quick Start Guide\n\n1. To run, type:\n```\n$ bosh-server\n```\nThe BOSH service is now available at: [http://localhost:5280/http-bind/](http://localhost:5280/http-bind/)\n\n2. For options, type:\n```\n$ bosh-server --help\n```\n\n3. For running from within a node application, type:\n\n    ```\n    $ node\n    > var nxb    = require(\"node-xmpp-bosh\");\n    > var server = nxb.start_bosh();\n    > \n    > // To stop, type:\n    > // server.stop();\n    >\n    ```\n\n4. For a more complex setup, see the file main.js\n\n\n\n### Features\n\n* Multiple Streams\n* Stream restarts\n* Request & Response Acknowledgements\n* STARTTLS support for connecting to the backend XMPP server (tested with google talk & jabber.org)\n* Custom stream attributes on stream restart requests\n* Custom attributes supported during session creation (passed on to handlers)\n* A client may request a custom inactivity period from the server by setting the 'inactivity' attribute in the session creation request\n* HTTP POST & GET (for older browsers) are suported (see below for more details)\n* A websocket server on the same port as the BOSH server\n* Benchmarks: https://github.com/dhruvbird/node-xmpp-bosh/wiki/Benchmarks\n* Monitor the BOSH server at [http://localhost:5280/http-bind/](http://localhost:5280/http-bind/) (available only if you have node-xmpp-bosh running on your system)\n* Get detailed information about the running service at [http://localhost:5280/http-bind/sysinfo/](http://localhost:5280/http-bind/sysinfo/) (available only if you have node-xmpp-bosh running on your system)\n\n\n### Features not Planned\n\n* gzip support for communicating with the backend XMPP server\n\n\n### Configuration parameters\n\nThe following parameters can be set in the configuration file (see the\nfile bosh.conf.example.js for an example). The limits mentioned below\nare all HARD limits. Soft limits are set internally, but can never\nexceed the HARD limits. You can run node-xmpp-bosh with a config file\nas:\n```\n$ bosh-server --config=PATH_TO_CONFIG\n```\n\nNote: The **=** sign is important here. Replacing the equal sign with a space will NOT work.\n\n* **path**: The path to listen on **(default: /http-bind/)**\n\n* **port**: The port to listen on **(default: 5280)**\n\n* **host**: The host to listen on **(default: 0.0.0.0)**\n\n* **logging**: The logging level to start the BOSH server with **(default: INFO)**. Options: ALL, TRACE, DEBUG, INFO, WARN, ERROR, FATAL, OFF.\n\n* **max_data_held**: The maximum allowable number of bytes that a POST request body may contain. Any request exceeding this value will be dropped **(default: 100000)**\n\n* **max_xmpp_stanza_size**: The maximum size of an incoming XMPP\n    stanza in bytes. If the stanza size exceeds this size, then the stream is terminated **(default: 500000)**\n\n* **max_bosh_connections**: The maximum number of simultaneous connections that the BOSH server will entertain for any open BOSH session **(default: 2)**\n\n* **window_size**: The size of the window when entertaining out of order requests **(default: 2)**\n\n* **default_inactivity**: The default (or minimum) inactivity value (in second) that the BOSH server will set for the session inactivity timeout **(default: 70)**\n\n* **max_inactivity**: The maximum inactivity value (in second) that the BOSH server will set for the session inactivity timeout **(default: 160)**\n\n* **http_headers**: A JSON (object) containing HTTP headers to pass on along with the response **(default: { })**\n\n* **no_tls_domains**: A list of Domains for which TLS should NOT be used if the XMPP server supports STARTTLS but does NOT require it **(default: [ ])**\n\n* **pidgin_compatible**: Set to 'true' if you want to be able to use pidgin (any any other libpurple based client) with node-xmpp-bosh. If you set this to 'true', then you lose the ability to create multiple streams on a session **(default: false)**\n\n* **trim_default_length**: The maximum length of an XML stanza to be printed. Set to -1 for unlimited line length. **(default: 256)**\n\n* **system_info_password**: The password used to protect the /PATH/sysinfo/ URL. The username to use when prompted for authentication is 'admin' **(default: [not set])**\n\n### Architecture\n\nThe project itself is divided into 4 main components as of now.\n\n1. A BOSH front end (bosh.js). This starts and HTTP server and manages\nthe BOSH sessions and XMPP streams on those sessions. Multiple\nStreams, message acks, etc... and handled by this component. This is\nan EventPipe.\n\n2. An XMPP (Jabber) Proxy that is responsible for making single client\nconnections to an XMPP server (xmpp-proxy.js). STARTTLS and any other\nXMPP specific features are handled by this component.  This can be\nreplaced with any other proxy component (such as 0MQ) that connects to\nthe backend server using any custom protocol. You could in theory\nwrite a Yahoo! Proxy that presents XMPP compliant XML stanzas to its\nusers but makes HTTP REST calls to communicate with the Yahoo! chat\nservers.  This is an EventEmitter.\n\n3. An endpoint lookup service (lookup-service.js) that implements\nrules for XMPP service endpoint discovery. This currently encodes\nvarious rules to try in order for discovering the service endpoint.\n\n4. An XMPP Proxy Connection (the glue) that connects the BOSH service\nto the XMPP Proxy (xmpp-proxy-connector.js). Using this abstraction,\nyou can connect different (or event multiple proxies) to the BOSH\nservice at the same time.\n\n\nYou can add more components such as a mailing service that sends\nemails to clients at their email addresses if the BOSH server is not\nable to send them certain messages (see the no-client event below).\n\n\n### Events Emitted by the BOSH service\n\n1. **stream-add**: Emitted when a new stream is requested by a client\n\n2. **stream-terminate**: Emitted when a client requests stream\ntermination\n\n3. **stream-restart**: Emitted when a client requests a stream restart\n\n4. **nodes**: Emitted when the client wants to send one or more XML\nstanzas to the backend server\n\n5. **no-client**: Emitted when a packet to be delivered to the client\ntimed out because the client was unavailable for more than a certain\namount of time.\n      \n6. **error**: Emitted when there is an irrecoverable error. You should\ntypically restart the service when this is emitted.\n\n7. **response-acknowledged**: Emitted when a certain response was\nacknowledged by the client (i.e. Client sent an ACK for a certain\nresponse that was sent to it).\n\n### Events Understood by the BOSH service\n\n1. **response**: Emitted (typically by the Connector) when the backend\nserver wants to send the client some XML stanza.\n\n2. **terminate**: Emitted when the backend server wants to terminate\nthe client's connection (stream).\n\n3. **stream-added**: Emitted when the backend server starts a new XMPP\nstream for the client.\n\n4. **stream-restarted**: Emitted when the backend server restarts an\nexisting XMPP stream for the client.\n\n### Custom attributes on BOSH streams\n\n1. If a session creation request has the 'ua' attribute, it shall be\nincluded in all events that involve that session. This is useful when\nembedding this library.\n\n2. If a stream restart request has the 'stream_attrs' attribute set,\nthen the value of that attribute is assumed to be a stringified JSON\nobject which is subsequently parsed and every key/value pair is added\nas an attribute of the stream \\<stream:stream\\> tag during this stream\nrestart. If you provide attributes such as 'xmlns' that the BOSH proxy\nwould have added by default, the defaults are ignored and the user set\nattribute values are preferred.\n\n3. The 'from' attribute (if sent by the client) is echoed back to the\nclient by the server as the 'to' attribute in the session (or stream)\ncreation response.\n\n### HTTP GET support\n      \nThe URL for the GET handler is the same as that for the post handler.\nHowever, instead of passing in the data in the request body, it is\npassed in via the *data=* GET query parameter. JSONP is also supported\nif the *callback=* GET query parameter is supplied.\n\n* Example with the request passed in as a GET parameter\n\n    ```\n    http://localhost:5280/http-bind/?data=<body/>\n    ```\n\n    Response:\n\n    ```\n    <body condition=\"item-not-found\" message=\"Invalid session ID\" type=\"terminate\"/>\n    ```\n\n* Example with the request and callback passed in as a GET parameter\n\n    ```\n    http://localhost:5280/http-bind/?data=<body/>&callback=res341\n    ```\n\n    Response:\n\n    ```\n    res341({\"reply\":\"<body xmlns=\"http://jabber.org/protocol/httpbind\" \n      condition=\"item-not-found\" message=\"Invalid session ID\" \n      type=\"terminate\"/>\"});\n    ```\n\n\n### References\n\n* [http://xmpp.org/extensions/xep-0124.html](http://xmpp.org/extensions/xep-0124.html)\n* [http://xmpp.org/extensions/xep-0206.html](http://xmpp.org/extensions/xep-0206.html)\n* [http://tools.ietf.org/html/draft-moffitt-xmpp-over-websocket-00](http://tools.ietf.org/html/draft-moffitt-xmpp-over-websocket-00)\n\n\n### Dependencies\n\n* [Node.js] (http://nodejs.org/)\n* [node-expat] (https://github.com/astro/node-expat)\n* [ltx] (https://github.com/astro/ltx)\n* [node-uuid](https://github.com/broofa/node-uuid)\n* [tav](https://github.com/akaspin/tav)\n* [underscore.js] (https://github.com/documentcloud/underscore)\n* [eventpipe] (https://github.com/dhruvbird/eventpipe)\n* [dns-srv] (https://github.com/dhruvbird/dns-srv)\n* [semver] (https://github.com/isaacs/node-semver)\n* [ws] (https://github.com/einaros/ws)\n* [node-lumberjack] (https://github.com/dhruvbird/node-lumberjack)\n* [ejs] (https://github.com/visionmedia/ejs)\n* [jsdom] (https://github.com/tmpvar/jsdom) for tests\n* [jslint] (https://github.com/reid/node-jslint) for running lintit.sh\n\n\n### Tested with\n\n* Servers:\n    1. [ejabberd](http://ejabberd.im/) hosted at [jappix.com](https://jappix.com/)\n    2. [M-Link](http://www.isode.com/products/m-link.html) hosted at [jabber.org](http://www.jabber.org/)\n    3. [Google Talk](http://www.google.com/talk/) hosted at [gmail.com](http://gmail.com/)\n    4. [Facebook](http://www.facebook.com/sitetour/chat.php) hosted at [chat.facebook.com](http://facebook.com/)\n    5. Pappu hosted at [talk.to](https://talk.to/)\n    6. [Prosody](http://prosody.im/) hosted at [dukgo.com](https://duck.co/#topic/28469000000637077)\n    7. [Openfire](http://www.igniterealtime.org/projects/openfire/) hosted at [ChatMe.im](http://chatme.im/)\n\n* Clients:\n    1. [strophe.js] (http://github.com/metajack/strophejs)\n    2. [JSJaC] (https://github.com/sstrigler/JSJaC) used at [jappix.org](http://jappix.org/)\n    3. [dojox.xmpp] (http://dojoapi-mirror.devs.nu/jsdoc/dojox/1.2/dojox.xmpp) (modified since node-xmpp-bosh doesn't support the authid attribute)\n    4. libpurple (pidgin as a client)\n    5. [strophe.js websocket client] (https://github.com/superfeedr/strophejs/tree/protocol-ed)\n    6. [node-xmpp] (https://github.com/astro/node-xmpp)\n\n\n### Tested using\n\n1. [strophe.js] (http://github.com/metajack/strophejs)\n\n\n### Running tests\n```\n$ cd tests\n$ node basic.js [params]     # To check basic working\n$ node send_recv.js [params] # To check message sending/stress testing\n$ node stress.js [params]    # To stress test node-xmpp-bosh\n```\n\n\n### Scaling\n\n* node-xmpp-bosh allows you to set custom HTTP headers in the response\nto every valid request. You can use this in combination with the\n[nginx-sticky-module](http://code.google.com/p/nginx-sticky-module/)  to\nload-blance requests across multiple running BOSH server instances.\n\n* You can also load balance based on the HTTP PATH requested by the\nclient. You may set up node-xmpp-bosh to accept requests as long as\nthey begin with /PREFIX/ and set up nginx to route requests to\n/PREFIX/A/ to one instance and requests to /PREFIX/B/ to another\ninstance and so on.\n\n\n### Other Connection Managers:\n* [List on xmpp.org](http://xmpp.org/about-xmpp/technology-overview/bosh/#impl-cm)\n* [Punjab - Python & Twisted](http://code.stanziq.com/punjab)\n* [Chirkut - Python & Twisted](https://github.com/directi/chirkut)\n* [JabberHTTPBind - Java](http://blog.jwchat.org/jhb/)\n* [Araneo - Python & Twisted](http://blog.bluendo.com/ff/bosh-connection-manager-update)\n* [rhb - Ruby](http://rubyforge.org/projects/rhb/)\n* [Ejabberd websocket module](https://github.com/superfeedr/ejabberd-websockets)\n\n\n### Identi.ca groups:\n* [node-xmpp-bosh](http://identi.ca/group/nodexmppbosh)\n\n\n### Services using node-xmpp-bosh\n\nYou can find a list [here](https://github.com/dhruvbird/node-xmpp-bosh/wiki/Services-using-node-xmpp-bosh)\n",
  "readmeFilename": "README.md",
  "_id": "node-xmpp-bosh@0.7.0",
  "_from": "node-xmpp-bosh"
}
